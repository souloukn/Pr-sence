<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi de Présence - Gestion d'Équipe</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-clipboard-check"></i>
                    <h1>Suivi de Présence</h1>
                </div>
                <div class="header-actions">
                    <button type="button" class="btn btn-secondary" id="exportBtn" aria-label="Exporter les données">
                        <i class="fas fa-download"></i>
                        <span>Exporter</span>
                    </button>
                    <button type="button" class="btn btn-primary" id="addPersonBtn" aria-label="Ajouter une nouvelle personne">
                        <i class="fas fa-user-plus"></i>
                        <span>Nouvelle Personne</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Dashboard Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalPersonnes">0</h3>
                        <p>Total Personnes</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalPresents">0</h3>
                        <p>Présents Aujourd'hui</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalAbsents">0</h3>
                        <p>Absents Aujourd'hui</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="tauxPresence">0%</h3>
                        <p>Taux de Présence</p>
                    </div>
                </div>
            </div>

            <!-- Date Selector & Search -->
            <div class="controls-bar">
                <div class="date-selector">
                    <button type="button" class="btn btn-icon" id="prevDayBtn" aria-label="Jour précédent">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <input type="date" id="dateSelector" class="date-input" aria-label="Sélectionner une date">
                    <button type="button" class="btn btn-icon" id="nextDayBtn" aria-label="Jour suivant">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button type="button" class="btn btn-secondary" id="todayBtn" aria-label="Aller à aujourd'hui">
                        <i class="fas fa-calendar-day"></i>
                        Aujourd'hui
                    </button>
                </div>
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Rechercher une personne...">
                </div>
                <div class="filter-buttons">
                    <button type="button" class="filter-btn active" data-filter="all" aria-pressed="true">
                        <i class="fas fa-list"></i> Tous
                    </button>
                    <button type="button" class="filter-btn" data-filter="present" aria-pressed="false">
                        <i class="fas fa-check"></i> Présents
                    </button>
                    <button type="button" class="filter-btn" data-filter="absent" aria-pressed="false">
                        <i class="fas fa-times"></i> Absents
                    </button>
                    <button type="button" class="btn btn-secondary" id="tableViewBtn" aria-pressed="false" aria-label="Basculer en vue tableau">
                        <i class="fas fa-table"></i>
                        <span>Tableau</span>
                    </button>
                </div>
            </div>

            <!-- People List -->
            <div class="people-section">
                <div class="section-header">
                    <h2>Liste des Personnes</h2>
                    <span class="count-badge" id="countBadge">0 personnes</span>
                </div>
                <div id="peopleList" class="people-grid">
                    <!-- People cards will be inserted here -->
                </div>
                <!-- Table view (Excel-like) -->
                <div id="tableSection" class="table-section" aria-hidden="true" hidden>
                    <div class="section-header">
                        <h2>Vue tableau</h2>
                        <div>
                            <button type="button" class="btn btn-secondary" id="tableExportBtn">
                                <i class="fas fa-download"></i>
                                <span>Exporter CSV</span>
                            </button>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="peopleTable" class="people-table" role="table">
                            <thead>
                                <tr>
                                    <th>Prénom</th>
                                    <th>Nom</th>
                                    <th>Email</th>
                                    <th>Poste</th>
                                    <th>Statut</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- rows inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div id="emptyState" class="empty-state" aria-live="polite">
                    <i class="fas fa-users"></i>
                    <h3>Aucune personne enregistrée</h3>
                    <p>Commencez par ajouter des personnes pour suivre leur présence</p>
                    <button type="button" class="btn btn-primary" id="emptyAddBtn">
                        <i class="fas fa-user-plus"></i>
                        Ajouter une personne
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal: Add/Edit Person -->
    <div id="personModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-content" role="document">
            <div class="modal-header">
                <h2 id="modalTitle">Nouvelle Personne</h2>
                <button type="button" class="modal-close" onclick="closeModal('personModal')" aria-label="Fermer la fenêtre">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="personForm" novalidate>
                <input type="hidden" id="personId">
                <div class="form-group">
                    <label for="nom">Nom <span class="required">*</span></label>
                    <input type="text" id="nom" required aria-required="true" aria-describedby="nomError" placeholder="Ex: Dupont" maxlength="60">
                    <div id="nomError" class="field-error" aria-live="polite"></div>
                </div>
                <div class="form-group">
                    <label for="prenom">Prénom <span class="required">*</span></label>
                    <input type="text" id="prenom" required aria-required="true" aria-describedby="prenomError" placeholder="Ex: Marie" maxlength="60">
                    <div id="prenomError" class="field-error" aria-live="polite"></div>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" aria-describedby="emailError" placeholder="nom@exemple.com" maxlength="254">
                    <div id="emailError" class="field-error" aria-live="polite"></div>
                </div>
                <div class="form-group">
                    <label for="poste">Poste / Fonction</label>
                    <input type="text" id="poste" aria-describedby="posteError" maxlength="100">
                    <div id="posteError" class="field-error" aria-live="polite"></div>
                </div>
                <div class="form-group">
                    <label>Couleur de l'avatar</label>
                    <div class="color-picker">
                        <button type="button" class="color-option active" data-color="#4F46E5"></button>
                        <button type="button" class="color-option" data-color="#0EA5E9"></button>
                        <button type="button" class="color-option" data-color="#10B981"></button>
                        <button type="button" class="color-option" data-color="#F59E0B"></button>
                        <button type="button" class="color-option" data-color="#EF4444"></button>
                        <button type="button" class="color-option" data-color="#8B5CF6"></button>
                        <button type="button" class="color-option" data-color="#EC4899"></button>
                        <button type="button" class="color-option" data-color="#14B8A6"></button>
                    </div>
                    <input type="hidden" id="avatar_color" value="#4F46E5">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('personModal')">
                        Annuler
                    </button>
                    <button type="submit" id="personSubmitBtn" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Enregistrer
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Presence Details -->
        <div id="presenceModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="presenceModalTitle" aria-hidden="true">
            <div class="modal-content" role="document">
            <div class="modal-header">
                <h2 id="presenceModalTitle">Marquer la Présence</h2>
                    <button type="button" class="modal-close" onclick="closeModal('presenceModal')" aria-label="Fermer la fenêtre">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="presencePersonId">
                <input type="hidden" id="presenceDate">
                <div class="presence-options">
                    <button type="button" class="presence-btn present" data-status="present">
                        <i class="fas fa-check-circle"></i>
                        <span>Présent</span>
                    </button>
                    <button type="button" class="presence-btn absent" data-status="absent">
                        <i class="fas fa-times-circle"></i>
                        <span>Absent</span>
                    </button>
                    <button type="button" class="presence-btn retard" data-status="retard">
                        <i class="fas fa-clock"></i>
                        <span>Retard</span>
                    </button>
                    <button type="button" class="presence-btn conge" data-status="conge">
                        <i class="fas fa-umbrella-beach"></i>
                        <span>Congé</span>
                    </button>
                </div>
                <div class="form-group">
                    <label for="presenceNotes">Notes (optionnel)</label>
                    <textarea id="presenceNotes" rows="3" placeholder="Ajouter des notes..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="js/main.js"></script>
</body>
</html>
